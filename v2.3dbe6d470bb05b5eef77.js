var YaGames;(()=>{"use strict";var e={393:(e,t,n)=>{n.d(t,{jG:()=>a,X$:()=>i,qs:()=>U,uQ:()=>l,sC:()=>o,Aw:()=>u,TT:()=>G,u8:()=>p,N3:()=>y,VT:()=>_,_X:()=>N,E0:()=>D,qf:()=>$,X0:()=>Y,Bz:()=>k,OI:()=>T,Xk:()=>F,cp:()=>V,$J:()=>O,Rh:()=>v,S:()=>b,Qq:()=>E,jt:()=>B,sF:()=>A,Al:()=>L,Gd:()=>x,yH:()=>X,HT:()=>C,Uh:()=>z,Vo:()=>Z,ce:()=>j,$4:()=>M,TI:()=>W,Sd:()=>H,_W:()=>ee,Ry:()=>R,lW:()=>ne,rS:()=>ae,Iq:()=>re,Vw:()=>K,XT:()=>oe,eU:()=>ie});var r=n(719);const a={GetList:e=>({action:"getList",type:r.y0,data:e}),GetProgress:e=>({action:"getProgress",type:r.y0,data:e}),SetProgress:e=>({action:"setProgress",type:r.y0,data:e})},o={CheckAvailability:e=>({type:"availability-methods",action:"check-availability",data:e})},s="adv-manager",i={GetDisabledState:()=>({type:s,action:"get-disabled-state"}),AdvShowFullscreen:()=>({type:s,action:"adv-show-fullscreen",timeout:1e4}),AdvShowRewardedVideo:()=>({type:s,action:"adv-show-rewarded-video",timeout:1e4}),AdvShowStickyBanner:()=>({type:s,action:"adv-show-sticky-banner",timeout:3e3}),AdvHideStickyBanner:()=>({type:s,action:"adv-hide-sticky-banner",timeout:3e3}),AdvStatusStickyBanner:()=>({type:s,action:"adv-status-sticky-banner",timeout:3e3})},c="auth",l={AuthDialogSuccess:e=>({type:c,action:"auth-dialog-success",data:e}),AuthDialogOpen:()=>({type:c,action:"auth-dialog-open",data:{initializer:"auth-manager-public"}}),HasAuth:()=>({type:c,action:"has-auth"})},d="bonuses",u={Consume:e=>({type:d,action:"consume",data:e}),Catalog:e=>({type:d,action:"catalog",data:e}),PlayerBonuses:e=>({type:d,action:"player-bonuses",data:e})},p={WriteText:e=>({type:"clipboard",action:"write-text",data:e})},h="document-events";var m,g=((m=g||{}).Click=`click${r.ej}`,m.Dblclick=`dblclick${r.ej}`,m.Mouseup=`mouseup${r.ej}`,m.Pointerup=`pointerup${r.ej}`,m.Touchend=`touchend${r.ej}`,m);const y={ClickOnBody:()=>({type:h,action:g.Click}),DblclickOnBody:()=>({type:h,action:g.Dblclick}),MouseupOnBody:()=>({type:h,action:g.Mouseup}),PointerupOnBody:()=>({type:h,action:g.Pointerup}),TouchendOnBody:()=>({type:h,action:g.Touchend})},f="get-games";const v={All:()=>({type:f,action:"all"}),Game:e=>({type:f,action:"game",data:{app_id:e}})},w="leaderboard",b={Description:e=>({type:w,action:"description",data:e}),Entries:e=>({type:w,action:"entries",data:e}),PlayerEntry:e=>({type:w,action:"player-entry",data:e}),Score:e=>({type:w,action:"score",data:e}),Stat:e=>({type:w,action:"stat",data:e})},P="local-storage",E={GetAll:()=>({type:P,action:"get-all"}),Clear:()=>({type:P,action:"clear"}),Del:e=>({type:P,action:"del",data:{key:e}}),Set:(e,t)=>({type:P,action:"set",data:{key:e,value:t}}),Backup:e=>({type:P,action:"backup",data:e})},S="metrika",A={ReachGoal:e=>({type:S,action:"reachGoal",data:e}),Params:e=>({type:S,action:"params",data:e})},k=e=>({type:"game-call-alert",data:e}),T=(e,t)=>({type:"game-measuring",action:e,data:t}),O=(e,t)=>({action:e,type:r.Tn,data:t}),I="feedback",D={CanReview:()=>({type:I,action:"can-review"}),RequestReview:()=>({type:I,action:"request-review"})};const x=()=>({type:"options",action:"get"}),_=()=>({type:"environment",action:"get",params:{withOptions:!0}}),C=e=>({type:"player",action:"get",data:e}),L=()=>({type:"notifications",action:"allow"}),R=e=>({type:"foolproof-sdk-init",data:e}),F=e=>({type:"game-reporter",action:"plugin_engine_data",data:e}),N=e=>({type:"error",data:e}),G=e=>({type:"csp",action:"violation",data:e}),$=()=>({type:"frame",action:r.ur.IframeLoaded}),j=()=>{var e;return{type:"sdk-bundle-start",data:{time:Date.now(),sdkVersion:"v2",sdkBundle:null==(e=window.YandexGamesSDKEnvironment)?void 0:e.APP_VERSION,isSdkLoader:Boolean(window.isSdkLoader)}}},M=e=>({type:"sdk-debug-log",data:e}),U=e=>({type:"alert",error:e}),B=()=>({type:"longtask"}),Y=()=>({type:"longtask_frame_ready"}),K=()=>({type:"user-action"}),V=e=>({type:"game-stats",data:e}),H=()=>({type:"sdk_initialization",data:{initialized:!0}}),W=(e,t)=>({type:r.Ul,action:e,data:t}),q="payments",X={GetCatalog:e=>({type:q,action:"get-catalog",data:e}),GetEnv:()=>({type:q,action:"get-env"}),GetPurchases:e=>({type:q,action:"get-purchases",data:e}),PurchaseStart:e=>({type:q,action:"purchase-start",data:e}),PurchaseConsume:e=>({type:q,action:"purchase-consume",data:e}),PurchaseDialogInit:()=>({type:q,action:"purchase-dialog-init"}),PurchaseDialogOpen:()=>({type:q,action:"purchase-dialog-open"}),PurchaseDialogShow:e=>({type:q,action:"purchase-dialog-show",data:e}),PurchaseDialogError:e=>({type:q,action:"purchase-dialog-error",data:e}),PurchaseDialogClose:()=>({type:q,action:"purchase-dialog-close"}),GetGamePurchaseEnabled:()=>({type:q,action:"get-game-purchase-enabled"})},J="player-info",z={GetData:e=>({type:J,action:"get-data",data:e}),IdsPerGame:e=>({type:J,action:"ids-per-game",data:e}),IncrementStats:e=>({type:J,action:"increment-stats",data:e}),SetData:e=>({type:J,action:"set-data",data:e}),SetStats:e=>({type:J,action:"set-stats",data:e}),Stats:e=>({type:J,action:"stats",data:e})},Q="screen-manager",Z={ExitFullscreen:()=>({type:Q,action:"exit-fullscreen"}),RequestFullscreen:()=>({type:Q,action:"request-fullscreen"}),ToggleFullscreen:()=>({type:Q,action:"toggle-fullscreen"}),GetState:()=>({type:Q,action:"get-state"})},ee={ListenersChange:e=>({type:"sdk-internal-event",action:"listeners-change",data:e})},te="shortcut-manager",ne={ShowPrompt:()=>({type:te,action:"show-prompt"}),CanShowPrompt:()=>({type:te,action:"can-show-prompt"})},re=e=>({type:"sdk-stats",data:e}),ae=e=>({type:"telegram",data:e}),oe={Fetch:e=>({type:"varioqub",action:"fetch",data:e})},se="yaMetrikaCounter",ie={ReachGoal:e=>({type:se,action:"reachGoal",data:e}),Hit:e=>({type:se,action:"hit",data:e})}},719:(e,t,n)=>{n.d(t,{y0:()=>s,ej:()=>h,VR:()=>r,BE:()=>p,ur:()=>a,Fs:()=>y,q1:()=>v,Tn:()=>d,US:()=>i,cV:()=>m,Ul:()=>f,Hn:()=>o});var r=(e=>(e.AudioAPI="AudioAPI",e.GameplayAPI="GameplayAPI",e.GamesAPI="GamesAPI",e.LoadingAPI="LoadingAPI",e.PluginEngineDataReporterAPI="PluginEngineDataReporterAPI",e))(r||{}),a=(e=>(e.GameInit="loading_api_game_init",e.GameReady="loading_api_game_ready",e.GameReadyForce="loading_api_game_ready_force",e.IframeAdded="loading_api_iframe_added",e.IframeError="loading_api_iframe_resources_error",e.IframeLoaded="loading_api_iframe_resources_loaded",e.ScriptInit="loading_api_script_init",e.TTIReady="loading_api_tti_ready",e))(a||{});const o=["GameplayAPI","LoadingAPI","PluginEngineDataReporterAPI"],s="achv-manager",i="game_api";var c,l=((c=l||{}).Pause=`${i}_pause`,c.Resume=`${i}_resume`,c);const d="gameplay_api";var u,p=((u=p||{}).Start=`${d}_start`,u.Stop=`${d}_stop`,u);const h="-on-body",m="screen_recorder";var g,y=((g=y||{}).Start=`${m}_start`,g.Stop=`${m}_stop`,g);const f="sdk-event";var v=(e=>(e.BONUS_AWARDED="BONUS_AWARDED",e.EXIT="EXIT",e.HISTORY_BACK="HISTORY_BACK",e))(v||{})},303:(e,t,n)=>{n.d(t,{O6:()=>a,U0:()=>r,X4:()=>i,_h:()=>s,f9:()=>o});const r="%TLD%",a="%DOMAIN_NAME%";var o=(e=>(e.BIG="big",e.ISLANDS_75="islands-75",e.ISLANDS_200="islands-200",e.ISLANDS_MIDDLE="islands-middle",e.ISLANDS_RETINA_MEDIUM="islands-retina-medium",e.ISLANDS_RETINA_SMALL="islands-retina-small",e.NORMAL="normal",e))(o||{});const s="0/0-0",i="YandexSDKLogError"},399:(e,t,n)=>{n.d(t,{Z:()=>o});const r=/(\w+)@|at (.+) \(/g;function a(e,t=0){var n;const a=Array.from(e.matchAll(r))||[];if(!a.length)return"unknown";if(0===t)return a[0][2];for(let e=Math.min(a.length-1,t);e>=0;e--){const t=null==(n=a[e])?void 0:n[2];if(t)return t}return"unknown"}function o(e){if(e)return a(e,0);try{throw new Error}catch(e){return a(e instanceof Error&&e.stack||"",2)}}},112:(e,t,n)=>{n.d(t,{T:()=>c,f:()=>i});var r=n(303),a=n(210),o=n(233);function s(e,t,n){"YaGames"in window||console.warn("Don't use logSDKError or logSDKGameError outside SDK");const r=(0,a.U)(e,t,n);r&&o.F.postToParent({data:r,type:"error"}).catch(console.warn)}function i(e,t={}){s("sdk",e,t),console.warn(e)}function c(e,t={}){s("sdk-game",e,t),console.error(e,r.X4)}},210:(e,t,n)=>{n.d(t,{U:()=>m});var r=n(399),a=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&d(e,n,t[n]);if(i)for(var n of i(t))l.call(t,n)&&d(e,n,t[n]);return e},p=(e,t)=>o(e,s(t));const h=[/Adv was delayed on/];function m(e,t,n){var a,o,s;const i=function(e,t){var n,r,a,o;const s={columnNumber:null!=(n=e.columnNumber)?n:-1,fileName:e.fileName||"",lineNumber:null!=(r=e.lineNumber)?r:-1,name:e.name||"Error",message:e.message||String(e),stack:(null==(a=e.stack)?void 0:a.slice(0,4e5))||""};return s.additional=p(u(u({},e.additional),t.additional),{version:parseInt((null==(o=window.YandexGamesSDKEnvironment)?void 0:o.APP_VERSION)||"0")}),s}(t,n);return c=i.message,h.some((e=>e.test(c)))?null:(n.message&&(i.message=n.message),n.prefix&&(i.message=`${n.prefix} ${i.message}`),{block:`ErrorCounter/common: ${e}`,error:i,level:null!=(a=n.level)?a:"error",source:e,sourceMethod:null!=(o=n.sourceMethod)?o:(0,r.Z)(i.stack),type:null!=(s=n.type)?s:"error"});var c}},512:(e,t,n)=>{n.d(t,{o:()=>a});var r=n(112);function a(){var e,t;if("undefined"==typeof window)return"";const n=(null==(t=null==(e=window.YandexGamesSDKEnvironment)?void 0:e.app)?void 0:t.id)||"";return n||(0,r.f)(new Error("Can not get appId from environment")),n}},557:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(393),a=n(233),o=n(659);function s(e,t="Dev",n){return new URLSearchParams((0,o.e)().search).get("debug-mode")?function(...o){const s=new Set("string"==typeof t?[t]:t);s.add("Sdk"),a.F.postToParent((0,r.$4)({prefix:e,tag:Array.from(s),color:n,data:o}))}:()=>{}}},954:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(393),a=n(112),o=n(512),s=n(233);const i=Object.create(null);const c={gameSessionUID:"",init(){},sendOnceDeprecatedUsage(e){var t;e in i||(i[e]=1,this.params({borrowParams:{sdkDeprecatedUsage:{key:e,appId:(0,o.o)()}},service:"undefined"==typeof window?"unknown":(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.serviceName)||"unknown"}))},params(e){s.F.hasParent()&&s.F.postToParent(r.sF.Params(e)).catch((e=>{(0,a.f)(e)}))},reachGoal(e,t,n){s.F.hasParent()&&s.F.postToParent(r.sF.ReachGoal({data:t,goal:e,params:n})).catch((e=>{(0,a.f)(e)}))}}},233:(e,t,n)=>{n.d(t,{F:()=>s});class r{constructor(){this.promises={},this.listeners={},this.callbacks={},this.addEventListener()}onExternalMessage(e,t){this._onMessage(this.listeners,e,t)}offExternalMessage(e,t){this._offMessage(this.listeners,e,t)}addEventListener(){window.addEventListener("message",(e=>{this.checkExternalEvent(e)&&this.handleEvent(e)}))}deletePromise(e){this.clearPromiseWaitTimeout(e),delete this.promises[e]}clearPromiseWaitTimeout(e){const t=this.promises[e];(null==t?void 0:t.timeoutId)&&(window.clearTimeout(t.timeoutId),delete t.timeoutId)}getExternalCallback(e){const{type:t,action:n,messageId:r,payload:a}=e.data||{};if(this.callbacks[r])return this.callbacks[r];return this.callbacks[r]=(e={})=>{const o={type:e.type||t,action:e.action||n,originMessageId:r,originPayload:a,data:e.data||{}};!function(e,t){t.error&&(e.error=String(t.error.message)||null,e.errorJSON=JSON.stringify(t.error)||null)}(o,e),this.postCallback(o),this.callbacks[r]=()=>{}},this.callbacks[r]}handleEvent(e){const{type:t,action:n,originMessageId:r,originPayload:a,data:o,error:s,errorJSON:i}=e.data||{},c=this.promises[r];c&&(this.deletePromise(r),void 0===s?c.resolve({type:t,action:n,originPayload:a,data:o}):c.reject(this.createErrorInstance(s,i)));const l=this.getExternalCallback(e),d=this.listeners[t]||[];for(const t of d)try{t(e,l)}catch(e){this.logError({prefix:"[Messaging]",sourceMethod:"_handleEvent"},e)}return e}createErrorInstance(e,t){if(!e&&t)try{const{message:e}=JSON.parse(t);if(e)return new Error(e)}catch(e){}return new Error(e||"Undefined error message")}checkExternalEvent(e){var t;return"YandexGamesSDK"===(null==(t=e.data)?void 0:t.source)}_offMessage(e,t,n){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new Error('Wrong argument "types"');for(const r of t)r in e&&(e[r]=e[r].filter((e=>e!==n)))}_onMessage(e,t,n){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new Error('Wrong argument "types"');for(const r of t)r in e||(e[r]=[]),e[r].push(n)}_post(e,t){const n=Date.now(),r=`${n}-${Math.random()}`;t=Object.assign({},t,{source:"YandexGamesSDK",messageId:r});let a=e=>{},o=e=>{};const s=new Promise(((e,t)=>{a=e,o=t}));this.promises[r]={promise:s,resolve:a,reject:o,time:n};try{e.postMessage(function(e,t){if("function"==typeof structuredClone)try{return structuredClone(e),e}catch(n){return t({block:"Utils",message:"Error structuredClone operation",additional:{error:n}},n),e}return e}(t,this.logError.bind(this)),"*")}catch(e){return this.deletePromise(r),Promise.reject(e)}if("timeout"in t){const{timeout:e}=t;"number"==typeof e&&e>0?this.promises[r].timeoutId=window.setTimeout((()=>{this.deletePromise(r);const e=new Error("Message rejected by timeout");e.additional={type:t.type,action:t.action},o(e)}),e):this.logError({prefix:"[Messaging]",sourceMethod:"_post",additional:{type:t.type,action:t.action}},new Error("Wrong timeout value"))}return s}}var a=n(210);class o extends r{constructor(){if(o.instance)return o.instance;super(),o.instance=this}get _parentTarget(){return window.parent!==window?window.parent:void 0}hasParent(){return Boolean(this._parentTarget)}postToParent(e){const t=this._parentTarget;return t?this._post(t,e):Promise.reject(new Error("No parent to post message"))}postCallback(e){const t=this._parentTarget;return t?this._post(t,e):Promise.reject(new Error(`No child to post message: type = ${e.type}, action = ${e.action}`))}logError(e,t){const n=(0,a.U)("sdk",t,e);n&&this.postToParent({data:n,type:"error"}).catch(console.warn)}}const s=new o},659:(e,t,n)=>{function r(){return null==window?void 0:window.location}n.d(t,{e:()=>r})},419:e=>{function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,r,a){n=n||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(n);var i=1e3;a&&"number"==typeof a.maxKeys&&(i=a.maxKeys);var c=e.length;i>0&&c>i&&(c=i);for(var l=0;l<c;++l){var d,u,p,h,m=e[l].replace(s,"%20"),g=m.indexOf(r);g>=0?(d=m.substr(0,g),u=m.substr(g+1)):(d=m,u="");try{p=decodeURIComponent(d),h=decodeURIComponent(u)}catch(e){console.warn(e);continue}t(o,p)?Array.isArray(o[p])?o[p].push(h):o[p]=[o[p],h]:o[p]=h}return o}},509:e=>{var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,n,r,a){return n=n||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var o=encodeURIComponent(t(a))+r;return Array.isArray(e[a])?e[a].map((function(e){return o+encodeURIComponent(t(e))})).join(n):o+encodeURIComponent(t(e[a]))})).filter(Boolean).join(n):a?encodeURIComponent(t(a))+r+encodeURIComponent(t(e)):""}},751:(e,t,n)=>{t.decode=t.parse=n(419),t.encode=t.stringify=n(509)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{if(void 0!==n){var e=n.u,t=n.e,r={},a={};n.u=function(t){return e(t)+(r.hasOwnProperty(t)?"?"+r[t]:"")},n.e=function(r){return t(r).catch((function(t){var o=a.hasOwnProperty(r)?a[r]:3;if(o<1){var s=e(r);throw t.message="Loading chunk "+r+" failed after 3 retries.\n("+s+")",t.request=s,t}return new Promise((function(e){setTimeout((function(){a[r]=o-1,e(n.e(r))}),0)}))}))}}})();var r={};(()=>{n.d(r,{default:()=>Zn});var e=(e=>(e.ABORT_CONTROLLER="abort-controller",e.GLOBAL_THIS="global-this",e.INTERSECTION_OBSERVER="intersection-observer",e.LEGACY="legacy",e.SMOOTH_SCROLL="smooth-scroll",e))(e||{});const t=e=>{const{async:t,content:n,crossOrigin:r,id:a,nonce:o,onErrCb:s,onLoadCb:i,src:c}=e,l=document.createElement("script");if(i&&(l.onload=i),s&&(l.onerror=s),l.type="text/javascript",t&&(l.async=t),c&&(l.src=c),o&&l.setAttribute("nonce",o),r&&l.setAttribute("crossOrigin",r),a&&(l.setAttribute("id",`${a}-script`),l.dataset.rcid=`load-script-${a}`),n){const e=document.createTextNode(n);l.appendChild(e)}return l};function a(e,t){return e.endsWith("/")||(e=`${e}/`),`${e}polyfill/${t}`}function o(e,t){return a(e,function(e){var t,n;return(null==(n=null==(t=window.loadPolyfillHash)?void 0:t[e])?void 0:n.contenthash)?`${e}.${window.loadPolyfillHash[e].contenthash}.js`:`${e}.js`}(t))}var s=n(393),i=n(719);function c(e,t){let n,r;return function(...a){const o=a,s=this;return n||(n=!0,setTimeout((()=>n=!1),t),r=e.apply(s,o)),r}}function l(e,t=!0){var n;const r=Object.create(null),a=[].concat(((null==(n=e.hash)?void 0:n.replace(/^#/,""))||"").split("&"),e.search.replace(/^\?/,"").split("&"));for(let e=0;e<a.length;e++){const n=a[e];if(!n)continue;const[o,s]=n.split("=");try{r[o]=t?decodeURIComponent(s):s}catch(e){console.warn(e)}}return r}var d=n(659);function u(e=window){var t;return(null==(t=e.YandexGamesSDK)?void 0:t.game)?e.YandexGamesSDK.game.info.isDraft:"true"===function(e,t){var n,r;if(t){if("entryQuery"in t){const n=t.entryQuery[e];return"string"==typeof n?n:void 0}return l(t)[e]}if("object"==typeof window)return(null==(r=null==(n=window.appData)?void 0:n.location)?void 0:r.entryQuery[e])||l((0,d.e)())[e]}("draft")}var p=n(557);const h=class{constructor(){this.resolve=()=>{},this.reject=()=>{},this.promiseState=0,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.promiseState=1,e(t)},this.reject=e=>{this.promiseState=2,t(e)}}))}get state(){return this.promiseState}};var m=n(112);const g=(0,p.a)("sdkTimeout");function y(e,t=function(){var e;switch(null==(e=navigator.connection)?void 0:e.effectiveType){case"slow-2g":return 4e4;case"2g":return 2e4;case"3g":return 1e4;default:return 5e3}}()){const n=new h;g("init",e),n.promise.catch((()=>{var n;const r=new Error(`[SDK] too long resolve for method '${e}'`);r.additional={speed:(null==(n=navigator.connection)?void 0:n.effectiveType)||"unknown",timeout:t},g("timeout",e),(0,m.f)(r)}));const r=setTimeout((()=>{n.reject()}),t);return()=>{g("resolve",e),n.resolve(),clearTimeout(r)}}class f{constructor(e){this.log=e,this.observers={},this.subscribe=(e,t)=>{var n,r;return(null!=(r=(n=this.observers)[e])?r:n[e]=[]).push(t),this.unsubscribe.bind(this,e,t)},this.unsubscribe=(e,t)=>{var n;if(!t)return void delete this.observers[e];const r=this.observers[e];if(!r)return void(null==(n=this.log)||n.call(this,`Observable: eventId {${e}} does not exist`));const a=r.indexOf(t);-1!==a&&r.splice(a,1)},this.notifyObservers=(e,t)=>e.forEach((e=>{const n=this.observers[e];n&&n.forEach((n=>{var r;try{n(t)}catch(t){null==(r=this.log)||r.call(this,`Observable: {${e}} event observer error`,t)}}))})),this.getObserversNumber=e=>{var t,n;return null!=(n=null==(t=this.observers[e])?void 0:t.length)?n:0}}}var v=n(233),w=(e,t,n)=>new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));const b={background:"#6c5b7b",text:"#ffffff"},P=class{constructor(){this.log=(0,p.a)("Achievements | Child frame","Dev",b),this.observable=new f(this.log),this.setProgress=(e,t)=>w(this,null,(function*(){return this.post(s.jG.SetProgress({id:e,progress:t}))})),this.getProgress=e=>w(this,null,(function*(){return this.post(s.jG.GetProgress({id:e}))})),this.getList=(...e)=>w(this,[...e],(function*(e=["allLocal"]){return this.post(s.jG.GetList({status:e}))})),this.on=({action:e,id:t=""},n)=>this.observable.subscribe(this.buildId(e,t),n),this.off=({action:e,id:t},n)=>this.observable.unsubscribe(this.buildId(e,t),n),this.post=e=>w(this,null,(function*(){this.log("post to parent",e.action,e.data);const t=y(`AchvManager.${e.action}`);return v.F.postToParent(e).then((t=>{var n;this.log("receive from parent",e,t);const{result:r,success:a,error:o}=t.data;return a&&r?(this.notify(e.action,null!=(n=e.data)?n:{},r),r):(this.log("reject",e,"due to error"),Promise.reject(o))})).finally((()=>{t()}))})),this.notify=(e,t,n)=>{const r=[this.buildId(e)];t.id&&r.push(this.buildId(e,t.id)),this.observable.notifyObservers(r,{data:n,payload:t})},this.buildId=(e,t="")=>`${e}${t}`}};P.init=()=>{const{getList:e,getProgress:t,off:n,on:r,setProgress:a}=new P;return{getList:e,getProgress:t,off:n,on:r,setProgress:a}};let E=P;var S=(e=>(e.ADV_IS_NOT_CONNECTED="ADV_IS_NOT_CONNECTED",e.UNKNOWN="UNKNOWN",e))(S||{});const A=(0,p.a)("NoAds","Adv"),k="yandex-games-no-ads-style";function T(){Array.isArray(window.yaContextCb)&&0!==window.yaContextCb.length&&(window.yaContextCb=[]),Array.isArray(window.yandexContextAsyncCallbacks)&&0!==window.yandexContextAsyncCallbacks.length&&(window.yandexContextAsyncCallbacks=[])}let O=!1;function I(){O||(O=!0,A("_disableAds"),function(){var e;if(document.getElementById(k))return;const t=document.createElement("style");t.id=k,t.textContent='\nbody div[id*="yandex_rtb"],\nbody div[id*="adfox"],\nbody iframe#bwiframe,\nbody iframe[src*="yabnrwall.html"],\nbody iframe[src*="yartbbnr.html"],\nbody yatag,\nbody yatag[class]\n{ display: none !important; }',null==(e=document.body)||e.appendChild(t)}(),function(){var e,t,n;const r={destroy(){A("Ya.Context.AdvManager.destroy disabled")},render(e,t){"function"==typeof t?t():"function"==typeof e.altCallback?e.altCallback():"function"==typeof e.onError&&e.onError({code:"YA_GAMES_ADS_DISABLED",text:"",type:"error"})}};"function"==typeof(null==(n=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:n.render)&&(window.Ya.Context.AdvManager.render=r.render),T();let a=window.Ya;Object.defineProperty(window,"Ya",{get(){var e;return(null==(e=null==a?void 0:a.Context)?void 0:e.AdvManager)&&a.Context.AdvManager!==r&&(a.Context.AdvManager=r),T(),a},set(e){var t;(null==(t=e.Context)?void 0:t.AdvManager)&&e.Context.AdvManager!==r&&(e.Context.AdvManager=r),a=e},enumerable:!0,configurable:!0}),window.Ya=window.Ya||{},window.Ya.Context=window.Ya.Context||{AdvManager:r},window.Ya.Context.AdvManager=r,A("disable Ya.Context.AdvManager.render")}())}function D(e){try{return String(e.message||e).substring(0,100)}catch(e){}return""}const x=(0,p.a)("AdvManager","Adv");function _(e,t){return"function"==typeof e[t]?(n=e[t],r=`Error in callback ${t}`,(...e)=>{try{return n(...e)}catch(e){(0,m.f)(e,{additional:{origError:D(e)},message:r})}}):()=>{};var n,r}class C{constructor(e){var t;this.callbacks={},this.onAdvDebugManagerExternalMessage=e=>{const{action:t}=e.data;switch(t){case"debug-action-showFullscreenAdv":this.showFullscreenAdvDebug(t);break;case"debug-action-showRewardedVideo":this.showRewardedVideoDebug(t);break;case"debug-action-switchStickyBanners":this.switchStickyBannersDebug(t)}},this.onAdvManagerExternalMessage=e=>{var t,n,r,a,o,s,i,c,l,d,u,p,h,g,y;const{action:f,data:v}=e.data;switch(x(`onAdvManagerExternalMessage ${f}`),f){case"adv-callback-open":null==(n=(t=this.callbacks).onOpen)||n.call(t);break;case"adv-callback-close":this.callOnAdvClose(v.wasShown);break;case"adv-callback-error":this.callOnAdvClose(!1);try{if("string"!=typeof(null==(r=null==v?void 0:v.error)?void 0:r.message)){const e=new Error("Undefined error message");try{e.additional=JSON.stringify(v)}catch(t){e.additional="undefined"}(0,m.f)(e)}}catch(e){}null==(o=(a=this.callbacks).onError)||o.call(a,new Error(v.error.message,{cause:v.error}));break;case"adv-callback-offline":this.callOnAdvClose(!1),null==(i=(s=this.callbacks).onOffline)||i.call(s);break;case"rewarded-video-callback-open":null==(l=(c=this.callbacks).onOpen)||l.call(c);break;case"rewarded-video-callback-rewarded":null==(u=(d=this.callbacks).onRewarded)||u.call(d);break;case"rewarded-video-callback-close":null==(h=(p=this.callbacks).onClose)||h.call(p);break;case"rewarded-video-callback-error":null==(y=(g=this.callbacks).onError)||y.call(g,new Error(v.error.message,{cause:v.error}));break;case"set-disabled-state":x('On "set-disabled-state" event',e.data,v.value),this.setDisabledState(v.value)}},this.adv=e.adv||{},this.checkDeprecatedOnAdvCloseUsage(),(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.isWorldWide)&&this.setDisabledState(!0),Object.defineProperty(this,"callbacks",{enumerable:!1,writable:!0}),Object.defineProperty(this.adv,"onAdvClose",{enumerable:!1,writable:!0}),v.F.onExternalMessage("adv-manager",this.onAdvManagerExternalMessage),v.F.onExternalMessage("adv-debug-manager",this.onAdvDebugManagerExternalMessage),this.updateDisabledState()}checkDeprecatedOnAdvCloseUsage(){"onAdvClose"in this.adv&&(0,m.T)(new Error('Deprecated usage "onAdvClose". Please, use `ysdk.adv.method({callbacks})` https://yandex.ru/dev/games/doc/sdk/sdk-adv'))}showFullscreenAdvDebug(e){this.showFullscreenAdv({callbacks:{onClose:t=>x(`${e} onClose, wasShown = ${t}`),onError:t=>x(`${e} onError, error =`,t),onOffline:()=>x(`${e} onOffline`),onOpen:()=>x(`${e} onOpen`)}})}showRewardedVideoDebug(e){this.showRewardedVideo({callbacks:{onClose:()=>x(`${e} onClose`),onError:t=>x(`${e} onError, error =`,t),onOpen:()=>x(`${e} onOpen`),onRewarded:()=>x(`${e} onRewarded`)}})}switchStickyBannersDebug(e){this.getBannerAdvStatus().then((({stickyAdvIsShowing:t})=>{t?this.hideBannerAdv().then((({stickyAdvIsShowing:t})=>{x(`${e} hideBannerAdv, stickyAdvIsShowing = ${t}`)})):this.showBannerAdv().then((({reason:t,stickyAdvIsShowing:n})=>{x(`${e} hideBannerAdv, stickyAdvIsShowing = ${n}, reason = ${t}`)}))}))}updateDisabledState(){v.F.postToParent(s.X$.GetDisabledState()).then((({data:e})=>{this.setDisabledState(e.value)})).catch(console.warn)}setDisabledState(e){x("setDisabledState",e),e?I():O&&(O=!1)}ensureCallbacksIsValid(e,t){if(!Object.keys(t).length)return;let n=["onClose","onError"];"showRewardedVideo"===e&&n.push("onRewarded");try{n=n.filter((e=>!(e in t&&"function"==typeof t[e])))}catch(e){(0,m.T)(new Error('Error in "ensureCallbacksIsValid"'),{additional:{error:String(e).substring(0,100)}})}if(n.length){const t=new Error(`Callbacks for "${e}" has unpresented methods. See https://yandex.ru/dev/games/doc/ru/sdk/sdk-adv`);(0,m.T)(t,{additional:{unpresentedMethods:n}})}}showFullscreenAdv({callbacks:e={}}={}){this.ensureCallbacksIsValid("showFullscreenAdv",e);const t=y("AdvManager.showFullscreenAdv");v.F.postToParent(s.X$.AdvShowFullscreen()).then((({data:{error:t}})=>{if(!t)return this.setCallbacks(e,["onClose","onOpen","onError","onOffline"]);if(u()&&t.message.includes("often than once per"))throw t;(0,m.f)(t),_(e,"onError")(t),_(e,"onClose")(!1),this.callDeprecatedOnClose(!1)})).catch((t=>{(0,m.f)(t),_(e,"onError")(t),_(e,"onClose")(!1),this.callDeprecatedOnClose(!1)})).finally((()=>{t()}))}showRewardedVideo({callbacks:e={}}={}){this.ensureCallbacksIsValid("showRewardedVideo",e);const t=y("AdvManager.showRewardedVideo");v.F.postToParent(s.X$.AdvShowRewardedVideo()).then((({data:{error:t}})=>{if(t)throw t;this.setCallbacks(e,["onOpen","onRewarded","onClose","onError"])})).catch((t=>{(0,m.f)(t),_(e,"onError")(t),_(e,"onClose")(!1)})).finally((()=>{t()}))}showBannerAdv(){return new Promise((e=>{const t=y("AdvManager.showBannerAdv");v.F.postToParent(s.X$.AdvShowStickyBanner()).then((({data:t})=>{e(t)})).catch((t=>{(0,m.f)(t),e({reason:S.UNKNOWN,stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}hideBannerAdv(){return new Promise((e=>{const t=y("AdvManager.hideBannerAdv");v.F.postToParent(s.X$.AdvHideStickyBanner()).then((({data:t})=>{e(t)})).catch((t=>{(0,m.f)(t),e({stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}getBannerAdvStatus(){return new Promise((e=>{const t=y("AdvManager.getBannerAdvStatus");v.F.postToParent(s.X$.AdvStatusStickyBanner()).then((({data:t})=>{e(t)})).catch((t=>{(0,m.f)(t),e({reason:S.UNKNOWN,stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}setCallbacks(e,t){this.callbacks={},t.forEach((t=>{this.callbacks[t]=_(e,t)}))}callOnAdvClose(e=!1){var t,n;this.callDeprecatedOnClose(e),null==(n=(t=this.callbacks).onClose)||n.call(t,e)}callDeprecatedOnClose(e=!1){if("function"==typeof this.adv.onAdvClose)try{this.adv.onAdvClose(e)}catch(e){(0,m.T)(e)}}}const L=new class{openAuthDialog(){const e=y("AuthManagerPublic.openAuthDialog",12e4),t=v.F.postToParent(s.uQ.AuthDialogOpen());return t.finally((()=>{e()})),t}};function R(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}var F=n(303);function N(e){return function(e,t){if("function"!=typeof t)throw new Error("Argument is not a function");let n;return function(...r){return--e>0&&t&&(n=t.apply(this,r)),e<=1&&(t=void 0),n}}(2,e)}const G=e=>{const t=new URL(e);class n{constructor(){this.items=[]}contains(e){return this.items.includes(e)}item(e){var t;return null!=(t=this.items[e])?t:null}get length(){return this.items.length}*[Symbol.iterator](){}}return{location:{ancestorOrigins:new n,hash:t.hash,host:t.host,hostname:t.hostname,href:t.href,origin:t.origin,pathname:t.pathname,port:t.port,protocol:t.protocol,search:t.search,assign:()=>{},reload:()=>{},replace:()=>{}}}},$="undefined"!=typeof window?window:G("https://yandex.ru/games/app/1");var j;const M=(0,n(557).a)("src/sdk/common/api/constructExternalApiUrl","Dev"),U="undefined"!=typeof window&&(null==(j=window.appData)?void 0:j.env)||void 0,B=l($.location).origin||void 0||$.location.origin;function Y(e){const[t,n,r]=B.match(new RegExp(`[./](${e})\\.([a-z.]+)$`))||["/yandex.ru","yandex","ru"],a=function(e,t="ru"){return e.replace(F.U0,t)}(((U?U.SDK_BACKEND_URL:"https://games-sdk.%DOMAIN_NAME%.%TLD%/games/api/sdk/v1")||"").replace(F.O6,n),r);return N((()=>M("BACKEND_SDK_URL",a))),a}function K(){var e,t;return Y("undefined"!=typeof window?(null==(e=window.YandexGamesSDKEnvironment)?void 0:e.serviceHostname)||(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.serviceName):void 0)}const V=n(954).Z;var H=n(751);function W(e,t,n){var r,a;if(!e)return;let o=function(e,t,n){let r;try{let t=new URL(e);r=H.parse((n?t.hash:t.search).slice(1))}catch(e){return}if(void 0===r)return;let a=null==r?void 0:r[t];return a?Array.isArray(a)?a[0]:a:void 0}(e,"sdk_url",t);if(void 0===o)return;const s=void 0!==n?n.SDK_CUSTOM_DOMAINS:process.env.SDK_CUSTOM_DOMAINS;if(!s)return;let i;try{i=JSON.parse(s)}catch(e){return}if(void 0===i)return;return null!=(a=null==(r=null==i?void 0:i[o])?void 0:r.apiDomain)?a:void 0}function q(e){var t;let n=new URL(e);if(null==(t=null==window?void 0:window.appData)?void 0:t.env){let e=W((0,d.e)().href,!0,window.appData.env);if(e)return n.hostname=e,n.href}return e}const X={small:F.f9.ISLANDS_RETINA_SMALL,medium:F.f9.ISLANDS_RETINA_MEDIUM,large:F.f9.ISLANDS_200},J={small:F.f9.ISLANDS_200,medium:F.f9.ISLANDS_200,large:F.f9.BIG};class z{constructor(e){this._personalInfo=e}getID(){return(0,m.T)(new Error("Player.getID() is deprecated. Please, use Player.getUniqueID().\nhttps://yandex.ru/dev/games/doc/dg/sdk/sdk-player.html#sdk-player__profile-data")),V.sendOnceDeprecatedUsage("Player.getID"),this._personalInfo.id}getUniqueID(){return this._personalInfo.uniqueID}getName(){return this._personalInfo.publicName}getMode(){var e;return null!=(e=this._personalInfo.mode)?e:""}getPayingStatus(){return v.F.postToParent(s.yH.GetGamePurchaseEnabled()).then((({data:{enabled:e}})=>{e||(0,m.T)(new Error("We provide data on the player's ability to pay in games that already support purchases"),{level:"warn"})})),this._personalInfo.payingStatus}getPhoto(e="medium"){var t,n,r;const a=X[e];if(!a)throw new Error(`Unknown size value ('${e}')`);if(this._personalInfo.avatarIdHash){let e=`${K()}/player`;return"undefined"!=typeof window&&(e=(null!=(r=null==(n=null==(t=window.appData)?void 0:t.env)?void 0:n.SDK_BACKEND_URL)?r:K())+"/player"),`${q(e)}/avatar/${this._personalInfo.avatarIdHash}/${a}`}return`https://avatars.mds.yandex.net/get-yapic/${F._h}/${a}`}}var Q=Object.defineProperty,Z=Object.getOwnPropertySymbols,ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,ne=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,re=(e,t)=>{for(var n in t||(t={}))ee.call(t,n)&&ne(e,n,t[n]);if(Z)for(var n of Z(t))te.call(t,n)&&ne(e,n,t[n]);return e};const ae=(e,t)=>{v.F.postToParent((0,s.rS)({playdeck:re({method:e},t)}))},oe="tgData",se=()=>(ae("getData",{key:oe}),new Promise(((e,t)=>{function n(r){var a;if(!(e=>{var t,n,r;return"getData"===(null==(r=null==(n=null==(t=e.data)?void 0:t.data)?void 0:n.playdeck)?void 0:r.method)})(r))return;v.F.offExternalMessage("telegram",n);const o=(null==(a=r.data.data.playdeck.value)?void 0:a.data)||"{}";if("string"==typeof o)try{e(JSON.parse(o))}catch(e){const n=new Error("Error parsing game data from telegram");n.additional={originalError:e},(0,m.f)(n,{prefix:"telegram"}),t({})}else e(o)}v.F.onExternalMessage("telegram",n),setTimeout((()=>{v.F.offExternalMessage("telegram",n),t()}),1e3)})));var ie=Object.defineProperty,ce=Object.defineProperties,le=Object.getOwnPropertyDescriptors,de=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,he=(e,t,n)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const me=c((e=>v.F.postToParent(s.S.Score(e)).then((({data:e})=>e.result))),1e3);class ge{getLeaderboardDescription(e){const t=y("Leaderboards.getLeaderboardDescription"),n=v.F.postToParent(s.S.Description({name:e})).then((({data:e})=>e));return n.finally((()=>{t()})),n}getLeaderboardStat(e){const t=y("Leaderboards.getLeaderboardStat"),n=v.F.postToParent(s.S.Stat({name:e})).then((({data:e})=>e));return n.finally((()=>{t()})),n}getLeaderboardEntries(e,t){const{includeUser:n=!1,quantityAround:r=5,quantityTop:a=5}=t||{},o=y("Leaderboards.getLeaderboardEntries"),i=v.F.postToParent(s.S.Entries({include_user:n,name:e,quantity_around:r,quantity_top:a})).then((({data:e})=>{const{avatarPrefix:t,result:n}=e,{entries:r,leaderboard:a,ranges:o,userRank:s}=n;return{entries:this.transformLeaderboardEntries(r,t),leaderboard:a,ranges:o,userRank:s}}));return i.finally((()=>{o()})),i}getLeaderboardPlayerEntry(e){return t=this,n=null,r=function*(){const{data:t}=yield v.F.postToParent(s.S.PlayerEntry({name:e}));return this.transformLeaderboardEntry(t.result,t.avatarPrefix)},new Promise(((e,a)=>{var o=e=>{try{i(r.next(e))}catch(e){a(e)}},s=e=>{try{i(r.throw(e))}catch(e){a(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,s);i((r=r.apply(t,n)).next())}));var t,n,r}setLeaderboardScore(e,t,n){ae("setScore",{value:t});const r={name:e,score:t};return this.lastTimeLeaderboardWasSend&&!this.canSetLeaderboardScoreByTime()?Promise.reject("The request to setLeaderboardScore can be sent no more than once per second"):(n&&(r.extraData=n),this.lastTimeLeaderboardWasSend=Date.now(),me(r))}canSetLeaderboardScoreByTime(){return Date.now()-this.lastTimeLeaderboardWasSend>1e3}transformLeaderboardEntry(e,t){const{avatarIdHash:n,lang:r,publicName:a,scopePermissions:o,uniqueID:s}=e.player,i=`${t}${n}`;return c=((e,t)=>{for(var n in t||(t={}))ue.call(t,n)&&he(e,n,t[n]);if(de)for(var n of de(t))pe.call(t,n)&&he(e,n,t[n]);return e})({},e),ce(c,le({player:{getAvatarSrc:(e="medium")=>(X[e]||(e="medium"),`${i}/${X[e]}`),getAvatarSrcSet:(e="medium")=>(X[e]||(e="medium"),`${i}/${X[e]} 1x, ${i}/${J[e]} 2x`),lang:r,publicName:a,scopePermissions:o,uniqueID:s}}));var c}transformLeaderboardEntries(e,t){return e.map((e=>this.transformLeaderboardEntry(e,t)))}}const ye=()=>{const e=new ge;return Promise.resolve(e)};function fe(e){return function(e){for(var t,n="",r=e.length,a=0;a<r;a++)t=e[a],n+=String.fromCharCode(t>251&&t<254&&a+5<r?1073741824*(t-252)+(e[++a]-128<<24)+(e[++a]-128<<18)+(e[++a]-128<<12)+(e[++a]-128<<6)+e[++a]-128:t>247&&t<252&&a+4<r?(t-248<<24)+(e[++a]-128<<18)+(e[++a]-128<<12)+(e[++a]-128<<6)+e[++a]-128:t>239&&t<248&&a+3<r?(t-240<<18)+(e[++a]-128<<12)+(e[++a]-128<<6)+e[++a]-128:t>223&&t<240&&a+2<r?(t-224<<12)+(e[++a]-128<<6)+e[++a]-128:t>191&&t<224&&a+1<r?(t-192<<6)+e[++a]-128:t);return n}(function(e,t){for(var n,r,a,o=e.replace(/[^A-Za-z0-9\+\/]/g,""),s=o.length,i=t?Math.ceil((3*s+1>>>2)/t)*t:3*s+1>>>2,c=new Uint8Array(i),l=0,d=0,u=0;u<s;u++)if(r=3&u,l|=((a=o.charCodeAt(u))>64&&a<91?a-65:a>96&&a<123?a-71:a>47&&a<58?a+4:43===a?62:47===a?63:0)<<18-6*r,3===r||s-u==1){for(n=0;n<3&&d<i;n++,d++)c[d]=l>>>(16>>>n&24)&255;l=0}return c}(e))}function ve(e,t){t&&Object.defineProperty(e,"signature",{enumerable:!1,configurable:!1,get:()=>t})}class we extends Error{constructor({code:e,httpStatus:t,message:n},r,a){super(n,r,a),this.name="PaymentsError",this.code=e,this.httpStatus=t,Object.setPrototypeOf(this,we.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,we)}toJSON(){return{code:this.code,httpStatus:this.httpStatus,message:this.message,name:this.name,stack:this.stack}}}const be=we,Pe=new Set(["ru","uk","be","kk","uz"]);var Ee=(e=>(e.BE="be",e.EN="en",e.KK="kk",e.RU="ru",e.TR="tr",e.UK="uk",e.UZ="uz",e))(Ee||{});const Se=Ee.RU;function Ae(e,t=Se,n=""){if(e){if("string"==typeof e)return e;if(t in e)return e[t]||n;if(!(e=>!e||Pe.has(e))(t)&&"en"in e)return e.en||n;if(Se in e)return e[Se]||n}return n}function ke(){var e,t;return`//yastatic.net/s3/games-static/static-data/images/payments/sdk${(null==(e=window.YandexGamesSDKEnvironment)?void 0:e.moneyCodeSymbol)?`/${null==(t=window.YandexGamesSDKEnvironment)?void 0:t.moneyCodeSymbol.toLowerCase()}`:""}`}let Te=function(){Te=()=>{},V.params({borrowParams:{payments:{appId:n(512).o(),productCurrencyCodeGet:!0}}})};class Oe{constructor(e){this._productData=e}get id(){return this._productData.id}get title(){return Ae(this._productData.title)}get description(){return Ae(this._productData.description)}get imageURI(){const{image:e}=this._productData;if(e&&"object"==typeof e&&"url_prefix"in e){const t=String(e.url_prefix);return/\.(png|jpg|svg)$/.test(t)?t:`${t}/default256x256`}return"https://yastatic.net/s3/games-static/static-data/images/payments/default-product-image.png"}get price(){const{price:e}=this._productData;return`${e}Â ${this.priceCurrencyCode}`}get priceValue(){return String(this._productData.price)}get priceCurrencyCode(){var e;return Te(),null==(e=window.YandexGamesSDKEnvironment)?void 0:e.moneyCodeSymbol}getPriceCurrencyImage(e="small"){if("svg"===e)return`${ke()}/currency-icon-m.svg`;let t="s";switch(e){case"medium":case"small":t=e.charAt(0);break;default:console.warn(`Unknown size value ('${e}')`)}const n=window.devicePixelRatio>=2;return`${ke()}/currency-icon-${t}${n?"@2x":""}.png`}toJSON(){return{id:this.id,title:this.title,description:this.description,imageURI:this.imageURI,price:this.price,priceValue:this.priceValue,priceCurrencyCode:this.priceCurrencyCode}}}class Ie{constructor(e){this.purchaseData=e}get productID(){return this.purchaseData.productID}get purchaseToken(){return this.purchaseData.purchaseToken}get developerPayload(){return this.purchaseData.developerPayload}toJSON(){return{productID:this.productID,purchaseToken:this.purchaseToken,developerPayload:this.developerPayload}}}const De=(0,p.a)("Payment");class xe{constructor(e={}){this._config=e,this.___test1212()}getCatalog(){return new Promise(((e,t)=>{const n=y("Payments.getCatalog");v.F.postToParent(s.yH.GetCatalog({lang:this._config.lang})).then((({data:t})=>{De("get-catalog result",t),e(t.products.map((e=>new Oe(e))))})).catch((e=>{t(e)})).finally((()=>{n()}))}))}purchase(e){"object"!=typeof e&&(e={id:e,developerPayload:""});const{developerPayload:t}=e;if(t){if("string"!=typeof t)return Promise.reject(new Error("developerPayload must be a string"))}else e.developerPayload="";return new Promise(((t,n)=>{v.F.postToParent(s.yH.PurchaseStart({paymentsConfig:this._config,purchaseConfig:e})).then((({data:{data:e,signature:n}})=>{De("purchase-start then");const r=new Ie({productID:e.product.id,purchaseToken:e.token,developerPayload:e.developerPayload});ve(r,n),t(r)})).catch((e=>{De("purchase-start catch"),n(e)}))}))}getPurchases(){return new Promise(((e,t)=>{const n=y("Payments.getPurchases");v.F.postToParent(s.yH.GetPurchases({paymentsConfig:this._config})).then((({data:{data:t,signature:n}})=>{De("getPurchases callback",t);const r=t.map((e=>new Ie({productID:e.product.id,purchaseToken:e.token,developerPayload:e.developerPayload})));ve(r,n),e(r)})).catch((e=>{t(e)})).finally((()=>{n()}))}))}consumePurchase(e){return new Promise(((t,n)=>{const r=y("Payments.consumePurchase");v.F.postToParent(s.yH.PurchaseConsume({token:e})).then((({data:e})=>{if(console.info("consumePurchase data"),console.info(e),!e||!e.token)throw new be({code:"CANNOT_CONSUME_PURCHASE",message:"Can not consume purchase."});t(!0)})).catch((e=>{n(e)})).finally((()=>{r()}))}))}___test1212(){var e,t,n;if("96458"!==(null==(e=window.YandexGamesSDKEnvironment)?void 0:e.app.id))return;if(!0!==(null==(n=null==(t=window.YandexGamesSDKEnvironment)?void 0:t.request.experiments)?void 0:n.test1212Payments))return;const r="position: fixed; left: 15px; padding: 0.3em; background: #fff; border: 1px solid #000; border-radius: 5px;";let a=document.createElement("div");a.setAttribute("id","payElement1212-noads"),a.setAttribute("style",`${r} top: 5px;`),a.textContent='purchase("noads")',a.onclick=()=>this.___test1212Purchase("noads"),document.body.appendChild(a),a=document.createElement("div"),a.setAttribute("id","payElement1212-3x3antiblock"),a.setAttribute("style",`${r} top: 40px;`),a.textContent='purchase("3x3antiblock")',a.onclick=()=>this.___test1212Purchase("3x3antiblock"),document.body.appendChild(a)}___test1212Purchase(e){function t(t){const n=document.getElementById(`payElement1212-${e}`);n&&(n.style.backgroundColor=t?"#0f0":"#f00")}this.purchase({id:e,developerPayload:""}).then((()=>t(!0))).catch((e=>{t(!1),(0,m.f)(e)}))}}const _e=function(e={}){const t=new xe(e);return new Promise(((e,n)=>{t.getCatalog().then((()=>e(t))).catch(n)}))},Ce={APP_VERSION:"",app:{id:""},browser:{lang:"ru"},clid:void 0,i18n:{lang:"ru",tld:"ru"},isStickyBannerEnabled:!1,isWorldWide:!1,isYandexApp:!1,isTelegram:!1,parentTimeOrigin:performance.timeOrigin,moneyCodeSymbol:"HOP",params:{},request:{},serverTime:Date.now(),serviceHostname:"yandex",serviceName:"yandex",useMockGameLinks:!1};let Le=()=>(window.YandexGamesSDKEnvironment||(0,m.f)(new Error("SDK environment: `window.YandexGamesSDKEnvironment` is undefined")),Le=()=>window.YandexGamesSDKEnvironment||Ce,Le());const Re={get app(){return Le().app},get browser(){return{lang:Le().i18n.lang}},get data(){return Le().data||{}},get i18n(){return Le().i18n},get payload(){return Le().params.payload},get isTelegram(){return Le().isTelegram},get domain(){var e;return Le().serviceName||(null==(e=Le().data)?void 0:e.secondDomain)||"yandex"}},Fe=Re,Ne=204800;function Ge(e){try{return JSON.stringify(e)}catch(e){return(0,m.f)(e),`${Date.now()}.${Math.random()}`}}class $e{constructor(e){this._playerId=e,this._dataHash=null,this._timestamp=0}isSamePlayer(e){return e===this._playerId}set dataHash(e){this._dataHash=e?Ge(e):null}validate(e){const t=Ge(e);return function(e){try{return(new TextEncoder).encode(e).length}catch(t){return function(e){let t=e.length;for(let n=e.length-1;n>=0;n--){let r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&n--}return t}(e)}}(t)>Ne?{error:new Error("The data is too large (bigger then 204800 bytes)."),reject:!0}:this._dataHash===t?{error:new Error("The data does not differ from the previous ones."),reject:!1}:{}}getWaitTime(){let e=200;const t=Math.abs(Date.now()-this._timestamp);return t<3e3&&(e=Math.max(200,3e3-t)),e}set timestamp(e){this._timestamp=e}}const je=(0,p.a)("Player");function Me(e,t){return(0,m.f)(t,e)}function Ue(e){const{data:t,signature:n}=function(e,t){if("signature"in e){const{signature:n}=e;if("string"==typeof n){const{data:e}=JSON.parse(fe(n.split(".")[1]));return{data:e,signature:n}}t({},new Error("response.signature is not a string"))}return{data:e}}(e,Me);return ve(t,n),t}function Be(e,t){if(void 0===t)return e;if(!Array.isArray(t))throw new Error("`keys` must be an Array");if(-1!==t.indexOf("signature"))throw new Error('`keys` must not contains "signature" key');const n={};return t.forEach((t=>{t in e&&(n[t]=e[t])})),n}function Ye(e){return!(!e||"object"!=typeof e)&&Object.values(e).every((e=>"number"==typeof e&&!isNaN(e)))}let Ke,Ve,He;v.F.onExternalMessage("auth",(e=>{if("changed"===e.data.action&&He){je("Call onLogoutCallback()");try{He()}catch(e){console.error()}He=void 0}}));class We extends z{constructor(e,t){super(e),this.dataPromise=null,this.getApiPromise=()=>new Promise(((e,t)=>{this.getPlayerData().then((t=>{this.data=t,e(t)})).catch((e=>{this.dataPromise=null,t(e)}))})),this.getPlayerData=()=>{return e=this,t=null,n=function*(){const{data:e}=yield v.F.postToParent(s.Uh.GetData({signed:this.config.signed}));return Ue(e)},new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));var e,t,n},this.getDataPromise=()=>void 0!==this.data?Promise.resolve(this.data):Fe.isTelegram?se().catch((()=>this.getPlayerData())):this.getApiPromise(),this.config=t,Ve&&Ve.isSamePlayer(this.getUniqueID())||(Ve=new $e(this.getUniqueID()))}onLogout(e){je("Set onLogout callback"),He=e}getIDsPerGame(){return v.F.postToParent(s.Uh.IdsPerGame({signed:this.config.signed})).then((({data:e})=>Ue(e)))}getData(e){return this.dataPromise=this.getDataPromise(),this.dataPromise.then((t=>Be(t,e)))}setData(e,t=!1){var n;if(Fe.isTelegram&&(n=e,ae("setData",{key:oe,value:JSON.stringify(n)})),!function(e){return"object"==typeof e&&null!==e}(e))return Promise.reject(new Error("Data is not valid"));this.data=e;const r=function(e,t=!1){const n=Ve.validate(e);return n.error?n.reject?Promise.reject(n.error):((0,m.T)(n.error),Promise.resolve(!0)):new Promise(((n,r)=>{Ke&&window.clearTimeout(Ke);let a=t?200:Math.max(200,Ve.getWaitTime());Ve.timestamp=Date.now(),Ke=window.setTimeout((()=>{v.F.postToParent(s.Uh.SetData({data:e})).then((()=>{Ve.dataHash=e,n(!0)})).catch((e=>{Ve.timestamp=0,Ve.dataHash=null,r(e)}))}),a)}))}(e,t);return t?r:Promise.resolve(!0)}getStats(e){return void 0===this.statsPromise&&(this.statsPromise=new Promise(((e,t)=>{v.F.postToParent(s.Uh.Stats({signed:this.config.signed})).then((({data:e})=>Ue(e))).then(e).catch(t).finally((()=>this.statsPromise=void 0))}))),this.statsPromise.then((t=>Be(t,e)))}setStats(e){return Ye(e)?v.F.postToParent(s.Uh.SetStats({stats:e})).then((({data:e})=>e.result)):Promise.reject(new Error("Stats is not valid"))}incrementStats(e){return Ye(e)?v.F.postToParent(s.Uh.IncrementStats({increments:e,signed:this.config.signed})).then((({data:e})=>Ue(e.result))):Promise.reject(new Error("Increments is not valid"))}}function qe(e){return t=this,n=null,r=function*(){return new Promise((t=>setTimeout((()=>t()),e)))},new Promise(((e,a)=>{var o=e=>{try{i(r.next(e))}catch(e){a(e)}},s=e=>{try{i(r.throw(e))}catch(e){a(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,s);i((r=r.apply(t,n)).next())}));var t,n,r}let Xe;try{Xe=window.localStorage}catch(e){}const Je=Xe||function(){let e={};return{clear(){e={}},getItem:t=>e[t],key:t=>Object.keys(e)[t],removeItem(t){delete e[t]},setItem(t,n){e[t]=String(n)},get length(){return Object.keys(e).length}}}(),ze=/iPad|iPhone|iPod/.test(navigator.platform),Qe=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Ze=ze||Qe,et=/app-[^.]+\.games\.s3\.yandex\.net$/.test((0,d.e)().hostname),tt=!et&&Ze,nt=N((()=>{(0,m.f)(new Error("localStorage is broken on iOS/MacOS - https://developer.apple.com/forums/thread/109909\nPlease use YaGames.init().then(ysdk => ysdk.getStorage()).then(storage => storage.setItem('key', 'value'))"))})),rt=class e{static setup(){tt&&Object.defineProperty(window,"localStorage",{get:function(){return nt(),Je}}),Ze&&et&&e.setProxy()&&e.backup()}static load(){if(e.onloadPromise_)return e.onloadPromise_;const t=e.getCustomLocalStorage();return t?(e.onloadPromise_=Promise.race([qe(5e3).then((()=>{throw new Error("LocalStorage timeout")})),v.F.postToParent(s.Qq.GetAll()).then((({data:e})=>{for(let[n,r]of Object.entries(e))t.setItem(n,String(r));return t}))]).catch((e=>(console.error(e),Je))),e.onloadPromise_):Promise.resolve(Je)}static getCustomLocalStorage(){if("function"!=typeof Proxy)return null;return new Proxy({clear(){Je.clear.call(Je),v.F.postToParent(s.Qq.Clear())},getItem:e=>Je.getItem.call(Je,e),key:e=>Je.key.call(Je,e),get length(){return Je.length},removeItem(e){Je.removeItem.call(Je,e),v.F.postToParent(s.Qq.Del(e))},setItem(e,t){Je.setItem.call(Je,e,String(t)),v.F.postToParent(s.Qq.Set(e,t))}},{get:function(e,t){return t in e?e[t]:e.getItem(String(t))},set:function(e,t,n){return e.setItem(String(t),n),!0}})}static setProxy(){const t=e.getCustomLocalStorage();return!!t&&(Object.defineProperty(window,"localStorage",{get:function(){return t}}),!0)}static backup(){const e=Object.create(null);for(let t=0;t<Je.length;t++){const n=Je.key(t);n&&(e[n]=Je.getItem(n))}v.F.postToParent(s.Qq.Backup(e))}};rt.onloadPromise_=null;let at=rt;function ot(){return!Ze&&Xe?Promise.resolve(Xe):at.load()}var st=Object.defineProperty,it=Object.getOwnPropertySymbols,ct=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,dt=(e,t,n)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ut=(e,t)=>{for(var n in t||(t={}))ct.call(t,n)&&dt(e,n,t[n]);if(it)for(var n of it(t))lt.call(t,n)&&dt(e,n,t[n]);return e};const pt=e=>({get id(){return e.id},get title(){return Ae(e.title)},get description(){return Ae(e.description)},get imageURI(){const{image:t}=e;return t&&"object"==typeof t&&"url_prefix"in t?/\.(png|jpg|svg)$/.test(String(t.url_prefix))?t.url_prefix:`${t.url_prefix}/default256x256`:"https://yastatic.net/s3/games-static/static-data/images/bonuses/default-bonus-image.png"}});(0,p.a)("Bonus");var ht=Object.defineProperty,mt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,yt=Object.getOwnPropertySymbols,ft=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable,wt=(e,t,n)=>t in e?ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bt=(e,t,n)=>new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));const Pt=()=>({lang:Fe.i18n.lang}),Et=class{constructor(){this.getCatalog=()=>bt(this,null,(function*(){var e;const{data:t}=yield v.F.postToParent(s.Aw.Catalog(Pt()));return(null!=(e=null==t?void 0:t.bonuses)?e:[]).map(pt)})),this.getPlayerBonuses=()=>bt(this,null,(function*(){const{data:e}=yield v.F.postToParent(s.Aw.PlayerBonuses(Pt()));return e?e.map((e=>{return t=((e,t)=>{for(var n in t||(t={}))ft.call(t,n)&&wt(e,n,t[n]);if(yt)for(var n of yt(t))vt.call(t,n)&&wt(e,n,t[n]);return e})({},pt(e.item)),n={receivedAt:e.created,token:e.token},mt(t,gt(n));var t,n})):[]})),this.consume=e=>v.F.postToParent(s.Aw.Consume({token:e})).then((({data:e})=>e))}};Et.init=()=>{const{getCatalog:e,getPlayerBonuses:t,consume:n}=new Et,r={getCatalog:e,getPlayerBonuses:t,consume:n};return r};let St=Et;const At=(0,p.a)("captureAlert"),kt=250;function Tt(e){var t,n;if("DIV"===e.tagName&&e.getAttribute("style")&&!e.querySelector("div")&&!e.classList.length&&!e.id){const e="OK"===(null==(t=document.querySelector("button"))?void 0:t.textContent)&&(null==(n=document.querySelector("span"))?void 0:n.textContent);e&&(At(`popup message = ${e}`),v.F.postToParent((0,s.Bz)({message:e.substring(0,kt),popup:!0})))}}function Ot(){const e="createUnityInstance"in window||"UnityLoader"in window;if(At("captureUnityAlert isUnity",e),!e)return;if(document.querySelectorAll("div[style]:not([id]):not([class])").forEach(Tt),"undefined"!=typeof MutationObserver){const e=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&setTimeout((()=>{Array.from(e.addedNodes).forEach(Tt)}),0)}))}));e.observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("unload",(()=>{e.disconnect()}))}}const It=new class{writeText(e){try{e=String(e)}catch(e){return Promise.reject(new Error("Error while stringified provided value"))}return new Promise(((t,n)=>{const r=y("ClipboardPublic.writeText");v.F.postToParent(s.u8.WriteText({text:e})).then((()=>t(void 0))).catch(n).finally((()=>{r()}))}))}};class Dt{constructor(e="desktop"){this._type=e}get type(){return this._type}isMobile(){return"mobile"===this.type}isTablet(){return"tablet"===this.type}isDesktop(){return"desktop"===this.type}isTV(){return"tv"===this.type}}var xt=n(399),_t=Object.defineProperty,Ct=Object.getOwnPropertySymbols,Lt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable,Ft=(e,t,n)=>t in e?_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nt=(e,t)=>{for(var n in t||(t={}))Lt.call(t,n)&&Ft(e,n,t[n]);if(Ct)for(var n of Ct(t))Rt.call(t,n)&&Ft(e,n,t[n]);return e};const Gt=(()=>{var e;const t=null==(e=window.YandexGamesSDK)?void 0:e.game.info;if(!t)return;const n=parseInt(t.appId,10);return n?{appId:n,developerId:t.publisher.id}:void 0})();const $t=[{regexp:new RegExp("User .+ already exists in users list!"),title:"User already exists in users list!"},{regexp:new RegExp("\\(Filename:.+Line: -?[0-9]+\\)"),title:"Unity"},{substr:"UnityEngine",title:"Unity"},{substr:"Dimensions must match",title:"Unity"},{substr:"Loading FSB failed for audio clip",title:"Unity"},{substr:"UnityLoader",title:"Unity"},{substr:"FS.syncfs operations in flight at once, probably just doing extra work",title:"Unity"},{substr:"GLSL",title:"GLSL"},{substr:"ValerypopoffJS plugin",title:"ValerypopoffJS plugin"},{substr:"https://github.com/cocos-creator/engine",title:"cocos-creator"},{substr:"Wicket.Ajax",title:"Wicket.Ajax"},{substr:'Error loading sound "%s"',title:'"loading sound"'},{substr:"Error loading image",title:'"loading image"'},{substr:"Error loading Texture",title:'"loading Texture"'},{substr:"Error loading asset",title:'"loading asset"'},{substr:"Error loading audio url",title:'"loading audio url"'},{substr:"Error loading animation resource",title:'"loading animation resource"'},{substr:"Failed to load resource:",title:'"loading resource"'},{substr:"Could not load",title:'"loading"'},{substr:"Failed to load",title:'"loading"'},{regexp:new RegExp("[Cc]ould not allocate memory"),title:"working with memory"},{substr:"Out of executable memory in function at index",title:"working with memory"},{substr:"memory access out of bounds",title:"working with memory"},{substr:"pre-main prep time: ",title:'"pre-main prep time"'},{substr:"FAILED DIGGING: ",title:'"DIGGING"'},{substr:"sth wrong with connection!",title:'"sth wrong with connection!"'},{substr:"Object2D is not available",title:'"Object2D is not available"'},{regexp:new RegExp("^Client : Error finish action.*?respawn$"),title:'"finish action respawn"'},{substr:"[TokenStorageYandex]",title:"TokenStorageYandex"},{substr:"TOO_SMALL_CONTAINER",title:"TOO_SMALL_CONTAINER"},{substr:"Too small container",title:"TOO_SMALL_CONTAINER"},{substr:"window.cb",title:"Error related to window.cb"},{substr:"Not allowed to call RecalculateBounds",title:"Not allowed to call RecalculateBounds"},{regexp:/Loading chunk.*?partner-code-bundles/,title:"Loading chunk partner-code-bundles errors"},{substr:"[pcode] Loading chunk",title:"Loading chunk partner-code-bundles errors"},{regexp:/Loading chunk \S+ failed after \d+ retries/,title:"Loading chunk loadable-components errors"},{substr:"loadable-components: failed to asynchronously load component",title:"Loading component loadable-components errors"}],jt=e=>{const t=(e=>e.map((e=>{if("object"==typeof e)try{return JSON.stringify(e)}catch(t){return`${e}: ${t.message}`}return String(e)})).join(" "))(e),n=(e=>{for(const t of $t)if(t.regexp&&-1!==e.search(t.regexp)||t.substr&&e.includes(t.substr))return{message:`[grouped] ${t.title}`,additional:{message:e}};return{message:e}})(t),r=new Error(n.message);return n.additional&&(r.additional=n.additional),r};function Mt(e,t){t&&(e.type=t),v.F.postToParent((0,s._X)(e)).catch((e=>{console.warn(e)}))}function Ut(e){return{data:{additional:{sdkVersion:2}},error:e,source:"game",sourceMethod:(0,xt.Z)(e.stack)}}const Bt=new class{constructor(e){this.source=e,window.addEventListener("error",this),"Promise"in window&&window.addEventListener("unhandledrejection",this)}addLogger(e){this.logger=e}handleEvent(e){this._handleEvent(e)}_handleEvent(e,t="error"){try{this._unsafeHandleEvent(e,t)}catch(e){console.warn("Couldn't handle event in ErrorCounter!",e)}}_unsafeHandleEvent(e,t){return"unhandledrejection"===e.type?this._unsafeHandlePromiseRejectionEvent(e):this._unsafeHandleErrorEvent(e,t)}_unsafeHandlePromiseRejectionEvent(e){var t;const{reason:n}=e;if(!n)return;let r;const a={};n.stack&&n.message?r=n.message:(r=String(n),"[object Event]"===r?r="event.type: "+n.type:"[object Object]"===r&&(a.unhandledObject=n,r=n.message||"Undefined error message")),(null==(t=n.target)?void 0:t.src)&&(a.src=n.target.src);const o={additional:a,message:"Unhandled rejection: "+r,name:"UnhandledPromiseError",stack:n.stack||""};console.error(o.message,F.X4,o),this._postError(o,"unhandled")}_unsafeHandleErrorEvent(e,t){var n,r,a,o,s;const{error:i}=e,c={columnNumber:null!=(r=null!=(n=e.colno)?n:null==i?void 0:i.columnNumber)?r:-1,fileName:e.filename||(null==i?void 0:i.fileName)||"",lineNumber:null!=(o=null!=(a=e.lineno)?a:null==i?void 0:i.lineNumber)?o:-1,message:e.message||(null==i?void 0:i.message)||"",name:(null==i?void 0:i.name)||"Error",stack:null!=(s=null==i?void 0:i.stack)?s:""};(Gt||(null==i?void 0:i.additional))&&(c.additional=Nt(Nt({},null==i?void 0:i.additional),Gt)),console.error(c.message,F.X4,c),this._postError(c,t)}_postError(e,t){var n;let r=(0,xt.Z)(e.stack);"ErrorListener.handleEvent"===r&&(r="unknown"),null==(n=this.logger)||n.call(this,{data:{additional:e.additional||{}},block:`${this.source}-${t}`,error:e,source:this.source,sourceMethod:r},t)}}("game");Bt.addLogger(Mt),function(){try{const e=console.error;console.error=(...t)=>{let n=t.filter((e=>e instanceof Error))[0];n||(n=jt(t));try{"string"==typeof t[1]&&t[1]===F.X4?t.splice(1,1):Mt(Ut(n),"console.error")}catch(e){}e.apply(console,t)}}catch(e){try{Mt(Ut(e),"error")}catch(e){}}}();const Yt=(0,p.a)("Events bus","Dev",{background:"#0072B5",text:"#ffffff"}),Kt=new f(Yt),Vt=[i.US,i.Tn,i.Ul],Ht=e=>{v.F.postToParent(s._W.ListenersChange({event:e,count:Kt.getObserversNumber(e)}))},Wt={EXIT:Ht,HISTORY_BACK:Ht},qt=(e,t)=>{Yt(`[ON]: {${e}}`,t);const n=Wt[e],r=Kt.subscribe(e,t);return null==n||n(e),()=>{r(),null==n||n(e)}},Xt=(e,t)=>{var n;Yt(`[OFF]: {${e}}`,t),Kt.unsubscribe(e,t),null==(n=Wt[e])||n.call(Wt,e)},Jt=(e,t)=>{Yt(`[NOTIFY OBSERVERS]: {${e}}`,...t?[t]:[]),Kt.notifyObservers(Array.isArray(e)?e:[e],t)};v.F.onExternalMessage(Vt,(({data:{action:e,data:t}})=>Jt(e,t)));const zt=(0,p.a)("Gameplay | Child frame","Dev",{background:"#6c5b7b",text:"#ffffff"}),Qt=e=>{zt(`[POST]: {${e}}`),v.F.postToParent((0,s.$J)(e))};const Zt=new Set;let en=!1;const tn="function"!=typeof Proxy?e=>e:(e,t,n)=>en?e:new Proxy(e,{get:(e,r)=>("symbol"!=typeof r&&!en&&t.includes(r)&&Zt.add(`${n}.${r}`),e[r])}),nn=()=>{en||(v.F.postToParent((0,s.Iq)(Array.from(Zt).join(","))),Zt.clear(),en=!0)},rn="/helpers/fake-page/1/index.html";const an=tn(new class{constructor(){this.promises=new Map}getAllGames(){const e=this.promises.get("all");if(e)return e;const t=y("getAllGames"),n=new Promise(((e,n)=>v.F.postToParent(s.Rh.All()).then((({data:t})=>{var n;(null==(n=window.YandexGamesSDKEnvironment)?void 0:n.useMockGameLinks)&&(t.games.forEach((e=>e.url=`${rn}`)),t.developerURL=`${rn}`),e(t)})).catch((e=>{this.promises.delete("all"),n(e)})).finally((()=>t()))));return this.promises.set("all",n),n}getGameByID(e){const t=this.promises.get(`${e}`);if(t)return t;const n=y("getGameByID"),r=new Promise(((t,r)=>v.F.postToParent(s.Rh.Game(e)).then((({data:e})=>{var n;(null==(n=window.YandexGamesSDKEnvironment)?void 0:n.useMockGameLinks)&&e.game&&(e.game.url=`${rn}`),t(e)})).catch((t=>{this.promises.delete(`${e}`),r(t)})).finally((()=>n()))));return this.promises.set(`${e}`,r),r}},["getGameByID","getAllGames"],"GamesAPI"),on=class e{constructor(){this.isReady=!1,this.startTimestamp=Date.now(),this.startReadyFallbackTimeout()}ready(){if(this.isReady)return void console.warn("Don't call %cfeatures.LoadingAPI.ready() %cmore than one time.","color: green","color: unset");this.isReady=!0;const e=Date.now()-this.startTimestamp;this.logGameInitTime(e,i.ur.GameReady),clearTimeout(this.readyFallbackTimerId)}logGameInitTime(e,t){v.F.postToParent((0,s.OI)(t,{timeFromInit:e}))}startReadyFallbackTimeout(){this.readyFallbackTimerId=window.setTimeout((()=>{this.logGameInitTime(e.MAX_TIMEOUT,i.ur.GameReadyForce)}),e.MAX_TIMEOUT)}};on.MAX_TIMEOUT=3e4;let sn=on;var cn;const ln={[i.VR.GameplayAPI]:class{start(){Qt(i.BE.Start)}stop(){Qt(i.BE.Stop)}},[i.VR.LoadingAPI]:sn,[i.VR.PluginEngineDataReporterAPI]:class{constructor(){this.isReported=!1}report(e){this.isReported?console.warn("Don't call %cfeatures.PluginEngineDataReporterAPI.report() %cmore than one time.","color: green","color: unset"):(this.logData(e),this.isReported=!0)}logData(e){v.F.postToParent((0,s.Xk)(e))}}};class dn{constructor(e={}){this[cn]=an;for(let t in i.VR)i.VR[t]in e&&e[i.VR[t]]&&(this[t]=new ln[t]);for(let t of i.Hn)!this[t]&&(t in e&&e[t]||!(t in e))&&(this[t]=new ln[t]);v.F.postToParent((0,s.OI)(i.ur.GameInit))}}i.VR.GameplayAPI,i.VR.LoadingAPI,i.VR.PluginEngineDataReporterAPI,cn=i.VR.GamesAPI;var un=(e=>(e.GAME_RATED="GAME_RATED",e.NO_AUTH="NO_AUTH",e.REVIEW_ALREADY_REQUESTED="REVIEW_ALREADY_REQUESTED",e.REVIEW_WAS_REQUESTED="REVIEW_WAS_REQUESTED",e.UNKNOWN="UNKNOWN",e))(un||{});const pn=new class{canReview(){return new Promise((e=>{const t=y("Feedback.canReview");v.F.postToParent(s.E0.CanReview()).then((({data:t})=>{e(t)})).catch((t=>{(0,m.f)(t),e({reason:un.UNKNOWN,value:!1})})).finally((()=>{t()}))}))}requestReview(){return new Promise((e=>{const t=y("Feedback.requestReview",12e4);v.F.postToParent(s.E0.RequestReview()).then((({data:t})=>{const{feedbackSent:n,reason:r}=t;r?((0,m.f)(r),e({feedbackSent:null!=n&&n})):e({feedbackSent:null==n||n})})).catch((t=>{(0,m.f)(t),e({feedbackSent:!1})})).finally((()=>{t()}))}))}};function hn(){v.F.postToParent((0,s.Ry)({url:location.href,draftDetectedInIframe:u()}))}function mn(e){try{return"WebGLRenderingContext"in window&&Boolean(e.getContext("webgl")||e.getContext("experimental-webgl")instanceof WebGLRenderingContext)}catch(e){(0,m.f)(e,{sourceMethod:"isWebGLSupported",level:"warn"})}return!1}function gn(e){try{return"WebGL2RenderingContext"in window&&Boolean(e.getContext("webgl2")||e.getContext("experimental-webgl2")instanceof WebGL2RenderingContext)}catch(e){(0,m.f)(e,{sourceMethod:"isWebGL2Supported",level:"warn"})}return!1}function yn(){const e=[];return"createUnityInstance"in window&&e.push("unity"),e}function fn(){const e=[],t={webassembly:"WebAssembly"in window,webgl:mn(document.createElement("canvas")),webgl2:gn(document.createElement("canvas"))};return Object.keys(t).filter((e=>t[e])).forEach((t=>{e.push(t)})),e}const vn=()=>{return e=void 0,t=null,n=function*(){return new Promise(((e,t)=>{const n=`${Date.now()}-${Math.random()}`,r=setTimeout((()=>{t(new Error("Get external iframe timeout"))}),500);window.addEventListener("message",(function t(a){const{data:o}=function(e){try{return{data:JSON.parse(e),error:null}}catch(e){return{data:null,error:e}}}(a.data);o&&o.messageId===n&&(window.removeEventListener("message",t),clearTimeout(r),e(o.payload))})),window.parent.postMessage(JSON.stringify({source:"YandexGamesSDK",actionName:"GET_IFRAME_ORIGIN_SRC",channel:"EARLY_SDK_EVENT",messageId:n}),"*")}))},new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));var e,t,n},wn={allow(){v.F.postToParent((0,s.Al)())}};function bn(...e){const t=e=>e&&"object"==typeof e;return e.reduce(((e,n)=>(Object.keys(n).forEach((r=>{const a=e[r],o=n[r];Array.isArray(a)&&Array.isArray(o)?e[r]=a.concat(...o):t(a)&&t(o)?e[r]=bn(a,o):e[r]=o})),e)),{})}function Pn(e){if(!e||"object"!=typeof e)return{};!function(e){"partnerId"in e&&(delete e.partnerId,console.warn("`partnerId` is deprecated in the SDKv2"))}(e)}function En(e,t={}){var n;return Pn(t),"object"==typeof(n=t)&&Object.keys(n).forEach((e=>{(0,m.f)(new Error(`Using deprecated key in YaGames.init options: ${e}`))})),function(e={}){return function(e){"adv"in e&&V.sendOnceDeprecatedUsage("SDK init options with adv");e.adv=e.adv||{},function(e){if("onAdvClose"in e&&"function"!=typeof e.onAdvClose)throw new Error('"onAdvClose" must be a function')}(e.adv)}(e),e}(bn(e||{},t))}const Sn=(e={})=>_e(e);const An=class{constructor(){this.promiseWrappers=Object.create(null)}getKey(e){return JSON.stringify(e)}getFor(e){return this.promiseWrappers[this.getKey(e)]}setFor(e,t){t?this.promiseWrappers[this.getKey(e)]=t:delete this.promiseWrappers[this.getKey(e)]}clear(){this.promiseWrappers=Object.create(null)}};const kn=(0,p.a)("PlayerProxy");const Tn=new An;function On(){return e=this,t=arguments,n=function*(e={}){var t;const n=null==(t=Tn.getFor(e))?void 0:t.promise;if(n)return n;const r=y("getPlayer",12e4),a=new h;return a.promise.finally((()=>{r()})),Tn.setFor(e,a),window.setTimeout((()=>{Tn.setFor(e,void 0)}),3e5),v.F.postToParent((0,s.HT)({config:e})).then((({data:t})=>{const{data:n,signature:r}=t,o=function(e,t,n){const r=new We(t,e);return ve(r,n),tn(r,["getPayingStatus","getStats","getData","getName"],"Player")}(e,n,r);a.resolve(o)})).catch((t=>{Tn.setFor(e,void 0),a.reject(t)})),a.promise},new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));var e,t,n}v.F.onExternalMessage("auth",(e=>{["auth-dialog-cancel","auth-dialog-success","changed"].includes(e.data.action)&&(kn("Clear getPlayer promises."),Tn.clear())}));class In{constructor(){this.onMessage=e=>{const{action:t}=e.data;"fullscreenchange"===t&&(document.dispatchEvent(new Event("fullscreenchange")),this._status=e.data.data.isFullscreen?"on":"off")},this._status="off",this.overrideBrowserFullscreenElement(),this.initMessaging(),this.updateStatus()}get STATUS_ON(){return"on"}get STATUS_OFF(){return"off"}get status(){return this._status}request(){const e=y("FullscreenManager.request"),t=v.F.postToParent(s.Vo.RequestFullscreen());return t.finally((()=>{e()})),t}exit(){const e=y("FullscreenManager.exit"),t=v.F.postToParent(s.Vo.ExitFullscreen());return t.finally((()=>{e()})),t}toggle(){const e=y("FullscreenManager.toggle"),t=v.F.postToParent(s.Vo.ToggleFullscreen());return t.finally((()=>{e()})),t}updateStatus(){v.F.postToParent(s.Vo.GetState()).then((e=>{const{isFullscreen:t}=e.data;this._status=t?"on":"off"}))}overrideBrowserFullscreenElement(){try{Object.getOwnPropertyDescriptor(document,"fullscreenElement")||Object.defineProperty(document,"fullscreenElement",{enumerable:!1,configurable:!0,get:()=>this.status===this.STATUS_ON?document.documentElement:null})}catch(e){(0,m.f)(e)}}initMessaging(){v.F.onExternalMessage("screen-manager",this.onMessage)}}class Dn{constructor(){this.fullscreen=new In}}const xn=Date.now(),_n=`active_${xn}`,Cn=`cursorHighlighter_${xn}`,Ln=`id_cursorHighlighter_${xn}`,Rn=e=>{let t;e||(()=>{if(document.head.querySelector(`#${Ln}`))return;const e=document.createElement("style");e.id=Ln,e.innerHTML=`\n        .${Cn} {\n            position: absolute;\n            z-index: 1000;\n\n            display: none;\n\n            width: 16px;\n            height: 16px;\n\n            pointer-events: none;\n\n            border: 3px solid #f00;\n            border-radius: 50%;\n\n            transform: translate(-50%, -50%);\n        }\n\n        .${Cn}.${_n} {\n            display: initial;\n        }\n    `,document.head.appendChild(e)})();let n,r,a,o=!1;const s=document.createElement("div"),{activeClass:i=_n,mainClass:c=Cn}=null!=e?e:{};s.classList.add(c),document.body.appendChild(s);const l=(e,t)=>{r=e,a=t,n||(n=requestAnimationFrame((()=>{n=0,s.style.left=`${r}px`,s.style.top=`${a}px`})))},d=({pageX:e,pageY:n})=>{clearTimeout(t),o=!0,s.classList.add(i),l(e,n)},u=({pageX:e,pageY:t})=>{o&&l(e,t)},p=()=>{t=setTimeout((()=>s.classList.remove(i)),250),o=!1};return{startHighlighting:()=>{document.addEventListener("mousedown",d),document.addEventListener("mousemove",u),document.addEventListener("mouseup",p)},stopHighlighting:()=>{document.removeEventListener("mousedown",d),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",p),s.classList.remove(i)}}};const Fn={[i.q1.EXIT]:!0};const Nn=["passport.ya","passport.yandex","an.yandex.ru","avatars.mds.yandex.net","/api/"];function Gn(e){const t=Cache.prototype[e];Cache.prototype[e]=function(e,n){return"GET"!==e.method||0!==e.url.indexOf("https://")||(r=e.url,Nn.some((e=>-1!==r.indexOf(e))))?Promise.resolve():("ignoreSearch"in(n=n||{})||(n.ignoreSearch=!0),t.call(this,e,n));var r}}const $n=class{static overrideCacheSearch(){("function"!=typeof Cache?(console.warn("Can not find `Cache` function"),0):"function"!=typeof Cache.prototype.match?(console.warn("Can not find `Cache.match` function"),0):"function"==typeof Cache.prototype.matchAll||(console.warn("Can not find `Cache.matchAll` function"),0))&&(Gn("match"),Gn("matchAll"))}};const jn=new class{canShowPrompt(){return new Promise((e=>{const t=y("Shortcut.canShowPrompt");v.F.postToParent(s.lW.CanShowPrompt()).then((({data:t})=>{e(t)})).catch((e=>{(0,m.f)(e)})).finally((()=>{t()}))}))}showPrompt(){return new Promise((e=>{const t=y("Shortcut.showPrompt",12e4);v.F.postToParent(s.lW.ShowPrompt()).then((({data:t})=>{e(t)})).catch((e=>{(0,m.f)(e)})).finally((()=>{t()}))}))}};var Mn=n(512);function Un(){return new Promise((e=>{if("loading"===document.readyState){const t=()=>{"loading"!==document.readyState&&(document.removeEventListener("readystatechange",t),e())};document.addEventListener("readystatechange",t)}else e()}))}const Bn=new An;function Yn(e={}){const{clientFeatures:t=[],defaultFlags:n={}}=e,r=Bn.getFor(e);if(r)return r.promise;const a=y("get_flags/fetch"),o=new h;return o.promise.finally((()=>{a()})),Bn.setFor(e,o),v.F.postToParent(s.XT.Fetch({clientFeatures:t})).then((({data:e})=>{const t=Object.assign(n,e);o.resolve(t)})).catch((()=>{o.resolve(n),Bn.setFor(e,void 0)})),o.promise}class Kn{reachGoal(e,t,n){v.F.postToParent(s.eU.ReachGoal({counterId:e,target:t,goalData:n}))}sendGoal(e,t,n){console.warn('"sendGoal" method is deprecated. Please use "reachGoal" instead.'),v.F.postToParent(s.eU.ReachGoal({counterId:e,target:t,goalData:n}))}hit(e,t={}){v.F.postToParent(s.eU.Hit({counterId:e,hitData:t}))}}var Vn=(e,t,n)=>new Promise(((r,a)=>{var o=e=>{try{i(n.next(e))}catch(e){a(e)}},s=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);i((n=n.apply(e,t)).next())}));const Hn=(0,p.a)("sdkv2");!function(){var e;if(u())At("alert hook disabled");else try{"function"==typeof window.alert&&(e=window.alert,window.alert=function(){const t=arguments[0];return At(`alert message = ${t}`),v.F.postToParent((0,s.Bz)({message:t.substring(0,kt)})),e.apply(this,arguments)}),window.addEventListener("load",Ot,{once:!0}),At("alert hook enabled")}catch(e){(0,m.f)(e,{prefix:"game_hook_alert exp error: ",level:"warn"})}}();const Wn=Vn(void 0,null,(function*(){return function({staticOrigin:n,version:r,logError:s}){if(window.loadPolyfillsPromise)return window.loadPolyfillsPromise;let i=[[e.LEGACY,Boolean(Array.prototype.at)],[e.INTERSECTION_OBSERVER,Boolean("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)],[e.SMOOTH_SCROLL,Boolean("scrollBehavior"in document.documentElement.style)],[e.ABORT_CONTROLLER,"undefined"!=typeof AbortController],[e.GLOBAL_THIS,"object"==typeof globalThis]].filter((([,e])=>!e));return window.loadPolyfillsPromise=new Promise(((e,o)=>{i.length?document.head.appendChild(t({id:"loadPolyfillHash",src:a(n,`stats-hash.js?v=${r||(new Date).setUTCHours(12,0,0,0)}`),onErrCb:o,onLoadCb:e})):e()})).then((()=>Promise.all(i.map((([e])=>new Promise(((r,a)=>{document.head.appendChild(t({id:e,src:o(n,e),onErrCb:a,onLoadCb:r}))}))))))).catch((e=>{s({block:"Polyfill",message:"Error while loading polyfills",additional:{error:e}})})),window.loadPolyfillsPromise}({staticOrigin:"//yastatic.net/s3/games-static/_/build",logError:(e,t)=>(0,m.f)(t,e)})})).then((()=>{(()=>{if(window.top!==window)return;const{hash:e,hostname:t,search:n}=(0,d.e)();if(!/(games\.s3\.yandex\.net|games-storage(-awst?)?\.yandex\.net)$/.test(t))return;const r=(0,Mn.o)();if(!r)return;let a;a=/games\.s3\.yandex\.net$/.test(t)?`https://yandex.ru/games/app/${r}${n}${e}`:`https://yandex.com/games/app/${r}${n}${e}`,window.top.location.replace(a)})(),hn(),window.loadEnvironmentPromise=window.loadEnvironmentPromise||new Promise(((e,t)=>{const n=y("loadEnvironment");v.F.postToParent((0,s.VT)()).then((({data:t})=>{e(t)})).catch((e=>{t(e)})).finally((()=>{n()}))})).then((e=>{const t=!("enviroment"in e&&"options"in e),n=t?e:e.enviroment;return window.YandexGamesSDKEnvironment=n,Hn("APP_VERSION",n.APP_VERSION),!t&&e.options})),function(e){const t=c(e,2e3),n=["click","keydown","keyup","mousedown","mouseenter","mouseleave","mouseup","pointerup","touchcancel","touchend","touchmove","touchstart"];n.forEach((e=>document.addEventListener(e,t,{passive:!0,capture:!0})))}((()=>v.F.postToParent((0,s.Vw)())))}));let qn,Xn;class Jn{constructor(e){var t,n;e=En(e),this.EVENTS={BONUS_AWARDED:i.q1.BONUS_AWARDED,EXIT:i.q1.EXIT,HISTORY_BACK:i.q1.HISTORY_BACK},this.dispatchEvent=function(e,t){const n=y("getSdkEventsDispatcher");return new Promise(((r,a)=>{if(!(e in Fn)){const t=`Yandex SDK Event ${e} is not in supported.`;return console.warn(t),void a(new Error(t))}const o={};if(void 0!==t)try{o.detail=JSON.stringify(t)}catch(e){return console.warn(e),void a(new Error('Wrong "detail" argument'))}v.F.postToParent((0,s.TI)(e,o)).then((()=>{r(!0)})).catch((e=>{a(e)})).finally((()=>{n()}))}))},this.onEvent=(e,t)=>(console.warn("Deprecated usage of `ysdk.onEvent`, please use `ysdk.on(...)` instead."),qt(e,t)),this.achievements=E.init(),this.adv=tn(new C(e),["showBannerAdv"],"AdvManager"),this.auth=L,this.bonuses=St.init(),this.clipboard=It,this.deviceInfo=new Dt(e.deviceType),Qn.deviceInfo=this.deviceInfo,this.environment=Fe,this.feedback=pn,this.isAvailableMethod=(n=this,e=>{const t=y("isAvailableMethod"),r=v.F.postToParent(s.sC.CheckAvailability({methodToVerify:e})).then((({data:t})=>{const{isAvailable:r}=t;if(!r)return!1;const a={leaderboards:ge,payments:xe,player:We,storage:at.getCustomLocalStorage()},o=e.split(".");let s=ut(ut({},a),n);for(let e=0;e<o.length;e++){const t=s[o[e]];if(!t)return!1;if(e===o.length-1)return"function"==typeof t;if(!R(t))return!1;s=R(t.prototype)?t.prototype:t}return!1}));return r.finally((()=>{t()})),r}),this.shortcut=jn,this.getLeaderboards=ye,this.getPayments=Sn,this.getPlayer=On,this.getStorage=ot,this.notifications=wn,this.analytics={yaMetrikaCounter:new Kn},this.screen=new Dn,this.features=tn(new dn(e.features),[i.VR.GameplayAPI,i.VR.LoadingAPI],"FeatureManager"),this.yandexApp={enabled:Boolean(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.isYandexApp)},this.serverTime=function(){var e,t;const n=performance.timeOrigin||Date.now(),r=(null==(e=window.YandexGamesSDKEnvironment)?void 0:e.serverTime)||n,a=(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.parentTimeOrigin)||n,o=(performance.timeOrigin||n)-a,s=performance.now.bind(performance);return()=>new Date(r+o+s()).valueOf()}(),this.getFlags=Yn,this.dispatch=Jt,this.on=qt,this.off=Xt}}function zn(e){if("complete"===document.readyState)e();else{const t=()=>{e(),window.removeEventListener("load",t)};window.addEventListener("load",t)}}try{Xn=new URLSearchParams((0,d.e)().hash.slice(1)).get("device-type")}catch(e){}class Qn{constructor(){throw new Error("Please, use `YaGames.init` instead.")}static longtaskObserver(){var e;const t="longtask";if("undefined"!=typeof PerformanceObserver&&(null==(e=PerformanceObserver.supportedEntryTypes)?void 0:e.includes(t))){let e;const n=()=>{clearTimeout(e),e=setTimeout((()=>{"complete"===document.readyState?r.disconnect():n()}),5e3)},r=new PerformanceObserver((e=>{e.getEntries().forEach((()=>{v.F.postToParent((0,s.jt)()),n()}))}));r.observe({entryTypes:[t]})}"complete"===document.readyState?v.F.postToParent((0,s.X0)()):window.addEventListener("load",(()=>{v.F.postToParent((0,s.X0)())}))}static init(e){return Vn(this,null,(function*(){let t=(0,d.e)().hash;try{const e=yield Vn(void 0,null,(function*(){let e;try{e=yield vn()}catch(e){console.warn("Error get IFrameURL",e)}return new URL(e||(0,d.e)().href)}));t=new URL(e).hash}catch(e){}return qn?(console.warn("YaGames was initialized"),qn):(this.longtaskObserver(),Hn("Start initialization"),yield Wn,qn=new Promise(((n,r)=>{!function(){const e=()=>{v.F.postToParent((0,s.Sd)()),window.removeEventListener("load",e)};"complete"===document.readyState?e():window.addEventListener("load",e)}();const a=a=>{try{let r=En(a,e);if(!r.deviceType)try{r.deviceType=new URLSearchParams(t.slice(1)).get("device-type")}catch(e){(0,m.f)(e,{message:"No deviceType in options"})}Un().then((()=>{const e=new Jn(r);e.environment.isTelegram&&ae("loading",{value:100}),r.hasAuth&&e.getPlayer({scopes:!1}),window.setTimeout(nn,6e4),n(tn(e,["auth","getFlags","getLeaderboards","getPayments","getStorage","serverTime"],"SDK")),function(){if(!new URLSearchParams((0,d.e)().search).get("debug-mode"))return;const{startHighlighting:e,stopHighlighting:t}=Rn();v.F.onExternalMessage(i.cV,(({data:{action:n}})=>{switch(n){case i.Fs.Start:e();break;case i.Fs.Stop:t()}}))}()}))}catch(e){(0,m.f)(e),r(e)}};window.loadEnvironmentPromise.then((e=>{e?a(e):new Promise(((e,t)=>{const n=y("loadOptions");v.F.postToParent((0,s.Gd)()).then((({data:t})=>{e(t)})).catch((e=>{t(e)})).finally((()=>{n()}))})).then(a).catch((e=>{console.warn(`Options load failed with error ${e}`),a()}))})).catch((e=>{(0,m.f)(e),a()})),setTimeout((()=>{const e={clientTech:fn(),gameTech:yn()};Hn("checkAndSendGameInfo tech data:",e),zn((()=>{v.F.postToParent((0,s.cp)(e))}))}),1e4)})),qn.then((()=>Hn("Initialized"))),qn)}))}}if(Qn.deviceInfo=new Dt(Xn),window.YaGames&&window.YaGamesAdded){const e='YaGames is already defined. Please, check double <script src="https://yandex.ru/games/sdk/v2"> on the page.';u()&&v.F.postToParent((0,s.qs)(new Error(e))),(0,m.T)(new Error(e))}else{if(window.parent!==window){const e=(0,s.ce)();console.info(`SDK Init. Version: ${e.data.sdkVersion}. Is loader: ${e.data.isSdkLoader}.`),v.F.postToParent(e)}try{at.setup()}catch(e){(0,m.f)(e)}window.top!==window&&Un().then((function(){Object.values(s.N3).forEach((e=>{const t=e(),[n]=t.action.split(i.ej);document.addEventListener(n,(()=>v.F.postToParent(t)),!0)}))})),$n.overrideCacheSearch(),"SecurityPolicyViolationEvent"in window?window.addEventListener("securitypolicyviolation",(({blockedURI:e,columnNumber:t,disposition:n,documentURI:r,effectiveDirective:a,lineNumber:o,originalPolicy:i,referrer:c,sample:l,sourceFile:d,statusCode:u,violatedDirective:p})=>{v.F.postToParent((0,s.TT)({blockedURI:e,columnNumber:t,disposition:n,documentURI:r,effectiveDirective:a,lineNumber:o,originalPolicy:i,referrer:c,sample:l,sourceFile:d,statusCode:u,violatedDirective:p}))})):console.warn("SecurityPolicyViolationEvent is not available for this browser")}zn((()=>{v.F.postToParent((0,s.qf)())})),window.YaGamesAdded=!0,window.YaGames=Qn;const Zn=Qn})(),YaGames=r.default})();
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/sdk/client/sdk-v2/production/v2.3dbe6d470bb05b5eef77.js.map